---
# 文章标题
title: 2.10 HTTP1.1 如何优化
# 文章内容摘要
# description:
# 文章内容关键字
keywords: HTTP 优化, HTTP 性能提升, 浏览器缓存, HTTP 缓存机制, Etag 校验, 304 Not Modified, 减少 HTTP 请求, 合并请求, CSS Sprites, webpack 打包优化, Base64 图片, 延迟加载, 懒加载, gzip 压缩, Brotli 压缩, 无损压缩, 有损压缩, WebP 图片, H264 视频, HTTP 响应压缩, 减少网络开销, 前端性能优化
# 发表日期
date: 2025-09-24
summary: 本节详细介绍了 HTTP1.1 如何优化，包括避免发送 HTTP 请求、减少 HTTP 请求次数、减少 HTTP 响应的数据大小等。
# 分类
categories:
  - 计算机网络
# 标签
tags:
  - 计算机基础
  - 计算机网络
  - HTTP协议
  - 性能优化
---

## 避免发送 HTTP 请求

**缓存技术**：通过在客户端保存「请求-响应」的数据，避免重复的网络请求，从而提升 HTTP/1.1 的性能。

工作机制：

- 客户端将第一次请求的 **URL 作为 key**，响应作为 **value**，形成映射关系并存入本地磁盘。
- 当再次发起相同请求时：客户端先在本地通过 key 查找缓存，若缓存存在且未过期，直接读取响应数据。

**过期判断**：服务器在响应头部中加入过期时间，客户端检查缓存的响应是否过期，若过期则重新请求。

**Etag 校验机制**：客户端在重新请求时，携带上次响应头部的 Etag 摘要。服务器比较本地资源摘要与 Etag：**不同**，返回最新资源；**相同**，返回 **304 Not Modified**，客户端继续使用缓存。

## 减少 HTTP 请求次数

### 减少重定向请求次数

当资源迁移后，服务器通过 **302 响应码** 和 **Location 头部** 通知客户端新地址，客户端需重新发送请求获取资源。

多次重定向将导致客户端多次发起 HTTP 请求，增加网络开销。

若由 **代理服务器完成重定向**，可减少消息传递次数，当代理服务器知晓重定向规则后，还可进一步减少消息传递。

### 合并请求

**原理**：将多个小文件请求合并为一个大文件请求。减少重复的 HTTP 头部发送，降低 TCP 连接建立和慢启动的开销。

**浏览器行为**：为防止请求阻塞，通常会并发 5–6 个请求，合并请求能减少 TCP 连接数。

**典型方式**：

- 使用 **CSS Image Sprites**：合并多张小图片为一张大图，再通过 CSS 切割。
- 使用 **webpack 等打包工具**：合并 JS、CSS 等资源为大文件。
- **Base64 嵌入图片**：将图片二进制数据编码为 Base64，嵌入 HTML 文件中。

**问题**：当大资源中的某个小资源更新时，必须重新下载整个大文件。

### 延迟发送请求

**按需获取**：仅在需要时才发送请求。

**应用场景**：页面首次加载时仅请求可见部分资源，当用户滚动页面时，再加载后续资源。

**效果**：减少初始阶段的 HTTP 请求次数。

## 减少 HTTP 响应的数据大小

### 无损压缩

**定义**：压缩后数据可完全恢复，适用于文本文件、可执行文件、源代码等。

**步骤**：

- 去除代码中的换行符和空格。
- 建立统计模型，用 **霍夫曼编码** 表示数据。

**实现方式**：

- 客户端通过请求头 **Accept-Encoding** 告知服务器支持的压缩算法。
- 服务器选择合适算法压缩响应，并在响应头 **Content-Encoding** 中标注。

**常见算法**：**gzip**、**br (Brotli)**：压缩效率高于 gzip，推荐使用。

### 有损压缩

**定义**：压缩后数据与原始数据不完全一致，但非常接近。

**特点**：舍弃次要信息，牺牲部分质量以提高压缩比，常用于 **音频、视频、图片**。

**实现**：通过请求头 **Accept** 中的 **q 质量因子** 告诉服务器期望的资源质量。

**图片压缩**：**WebP 格式**：在相同质量下体积小于 PNG，适合大量图片场景。

**音视频压缩**：使用关键帧 + 增量数据表示连续帧。

**视频格式**：H264、H265。

**音频格式**：AAC、AC3。
