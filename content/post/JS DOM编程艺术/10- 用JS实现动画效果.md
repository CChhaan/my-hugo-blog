---
# 文章标题
title: 第十章 用JS实现动画效果
# 文章内容摘要
# description: 本文详细介绍了 Git 这一分布式版本控制系统的优点，对比了 Windows 与 macOS/Linux 系统下的常用命令，讲解了 vim 操作模式及常用命令，还阐述了 Git 的基本配置、特定项目配置和命令缩写设置等内容。
# 文章内容关键字
keywords: JavaScript 动画，position 属性，setTimeout, parseInt, Math 取整，overflow 属性，动画原理
# 发表日期
date: 2025-08-23
summary: 本章详细介绍了 JavaScript 动画实现的核心原理，包括元素位置控制、时间调度和数值处理等关键知识点。通过这些原理，读者可以更好地理解动画的实现过程，并能够编写出更加流畅和逼真的动画效果。
# 分类
categories:
  - JS DOM编程艺术
# 标签
tags:
  - JS 动画实现
  - 元素定位
  - 时间调度
  - 数值处理
  - 前端开发
---

## 动画基础知识：核心原理

JS 动画的本质是**按预定时间间隔重复调用函数，动态修改元素样式**（尤其是位置相关样式），从而实现 “随时间变化” 的视觉效果。核心依赖两个维度：**元素位置控制**和**时间调度**。

## 元素位置控制：`position` 属性

通过 CSS `position` 属性定义元素的定位方式，是实现动画的基础。`position` 有 4 个合法值，核心差异在于元素是否脱离文档流及定位基准：

| 属性值     | 定位规则                                                                                                                                                           |
| ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --- |
| `static`   | 默认值，元素按文档流顺序排列，无法通过 `top`/`left` 等属性调整位置。                                                                                               |     |
| `relative` | 元素仍在文档流中，但可通过 `top`/`left` 等属性 “相对自身原位置” 偏移，不影响其他元素。                                                                             |
| `absolute` | 元素脱离文档流，定位基准为**最近的已定位祖先元素**（`position` 为 `relative`/`fixed`/`absolute`），若无则以文档为基准。位置由 `top`/`left`/`right`/`bottom` 决定。 |
| `fixed`    | 元素脱离文档流，定位基准为浏览器窗口，滚动页面时位置固定不变。                                                                                                     |

### 位置属性使用注意：

- 避免冲突：设置位置时建议只使用 `top` 或 `bottom`（垂直方向）、`left` 或 `right`（水平方向），同时设置可能导致定位混乱。

- 容器定位：若需让 absolute 元素在指定容器内定位，需将容器的 position 设为 relative（此时容器成为定位基准）

## 时间调度：`setTimeout` 与 `clearTimeout`

通过 JS 时间函数控制动画的 “节奏”，实现 “延迟执行” 或 “定时重复”。

### `setTimeout`：延迟执行函数

- 语法：

  ```
  const timerId = setTimeout(func, delay)
  ```

  - `func`：延迟后执行的函数（可直接写函数体或函数名，推荐用函数体避免字符串解析问题）；
  - `delay`：延迟时间（毫秒，1 秒 = 1000 毫秒）；
  - 返回值：`timerId`（定时器唯一标识，用于取消定时器）。

### `clearTimeout`：取消延迟执行

- 语法：

  ```
  clearTimeout(timerId)
  ```

  - 作用：取消已通过 `setTimeout` 排队的函数，避免其执行

## 数值处理：`parseInt` 与 `parseFloat`

动画中常需从样式字符串（如 `100px`）中提取数值，需用到这两个函数：

| 函数         | 功能                                                     |
| ------------ | -------------------------------------------------------- |
| `parseInt`   | 提取字符串中的整数，忽略非数字部分（仅保留开头的数字）。 |
| `parseFloat` | 提取字符串中的浮点数（支持小数点），忽略非数字部分。     |

- **注意**：若字符串非数字开头，返回 `NaN`（如 `parseInt("abc123")` → `NaN`）。

## 实用动画辅助知识

### 内容溢出控制：`overflow` 属性

当动画元素尺寸超出容器时，需用 `overflow` 处理溢出内容，避免影响页面布局：

| 属性值    | 效果                                             |
| --------- | ------------------------------------------------ |
| `visible` | 不裁剪溢出内容，内容显示在容器外（默认值）。     |
| `hidden`  | 裁剪溢出内容，仅显示容器内部分，不显示滚动条。   |
| `scroll`  | 裁剪溢出内容，始终显示滚动条（无论是否溢出）。   |
| `auto`    | 裁剪溢出内容，仅在内容溢出时显示滚动条（推荐）。 |

### 数值取整：`Math` 对象的方法

动画中计算位置时，常需将浮点数转为整数（避免像素偏差），`Math` 对象提供 3 个核心方法：

| 方法            | 功能                                    |
| --------------- | --------------------------------------- |
| `Math.ceil(x)`  | 向上取整（返回不小于 `x` 的最小整数）。 |
| `Math.floor(x)` | 向下取整（返回不大于 `x` 的最大整数）。 |
| `Math.round(x)` | 四舍五入取整（返回最接近 `x` 的整数）。 |

### 动画可用性原则

- 允许用户控制：若页面有自动动画（如滚动字幕、轮播），需提供 “暂停 / 继续” 按钮，避免影响用户阅读（尤其对无障碍用户）。
