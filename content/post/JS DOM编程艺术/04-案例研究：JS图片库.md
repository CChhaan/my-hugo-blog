---
# 文章标题
title: 第四章 案例研究：JS图片库
# 文章内容摘要
# description: 本文详细介绍了 Git 这一分布式版本控制系统的优点，对比了 Windows 与 macOS/Linux 系统下的常用命令，讲解了 vim 操作模式及常用命令，还阐述了 Git 的基本配置、特定项目配置和命令缩写设置等内容。
# 文章内容关键字
keywords: DOM 进阶操作，事件处理函数，childNodes, nodeType, setAttribute, onload 事件，节点遍历
# 发表日期
date: 2025-08-17
summary: 本章详细介绍了 DOM 节点操作中的元素属性操作、JS 文件优化、事件处理函数以及节点遍历等内容。
# 分类
categories:
  - JS DOM编程艺术
# 标签
tags:
  - DOM 节点操作
  - 事件处理
  - 属性操作
  - 节点遍历
  - 前端开发
---

## 元素属性操作的两种方式

### 直接属性赋值（传统方式）

- **语法**：`element.属性名 = 值`（如 `input.value = "hello"`）。
- **适用场景**：大部分 HTML 元素的标准属性（如 `value`、`src`、`href` 等）。
- **特点**：简单直接，但仅支持预定义的标准属性，不支持自定义属性。

### `setAttribute()` 方法（DOM Level 1）

- **语法**：`element.setAttribute(属性名, 属性值)`（如 `div.setAttribute("data-id", "123")`）。
- 优势：
  - 可设置**任意元素的任意属性**（包括自定义属性），兼容性更强。
  - 遵循 DOM 标准，可移植性好（适用于多种环境和编程语言）。
- **注意**：修改后会实时反映在 DOM 中，但不会改变原始 HTML 源代码。

## JS 文件优化：合并文件

- **目的**：减少 HTTP 请求次数，提高页面加载性能。
- **做法**：将多个 `.js` 文件合并为一个文件，通过单次请求加载。

## 事件处理函数

### 基本概念

- **作用**：在特定事件发生时执行指定 JS 代码（如点击、鼠标悬停等）。
- **语法**：`元素.事件处理函数 = "JS 语句"` 或通过 DOM 方法绑定（如 `element.onclick = function() {}`）。
- 常用事件：
  - `onclick`：用户点击元素时触发；
  - `onmouseover`：鼠标指针悬停在元素上时触发；
  - `onmouseout`：鼠标指针离开元素时触发；
  - `onload`：页面或资源（如图片）加载完成时触发（常用于页面初始化）。

### 事件处理函数的返回值

- 事件触发的 JS 代码可返回一个值，该值会传递给事件处理函数。
- 典型应用：阻止默认行为
  - 例如，在\<a\>标签的 onclick 中返回 false，可阻止链接跳转：

### 子节点获取：`childNodes`

- **作用**：返回当前元素的**所有子节点**（包含元素节点、文本节点、空格 / 换行节点等），结果为类数组对象。

- 示例：

  ```js
  const parent = document.getElementById("parent");
  const children = parent.childNodes; // 所有子节点（含文本、空格等）
  ```

### 节点类型判断：`nodeType`

- 作用：通过数值区分节点类型（共 12 种，常用 3 种）：

  - 元素节点：`nodeType = 1`；
  - 属性节点：`nodeType = 2`；
  - 文本节点：`nodeType = 3`。

- 用途：过滤 childNodes 中的有效节点（如仅保留元素节点）：

  ```js
  for (let i = 0; i < parent.childNodes.length; i++) {
    if (parent.childNodes[i].nodeType === 1) {
      // 处理元素节点
    }
  }
  ```

### 文本节点值操作：`nodeValue`

- **作用**：获取或设置节点的值（仅对文本节点、属性节点有效）。

- **注意**：元素节点的文本内容存放在其**第一个子节点**（文本节点）中，需通过 `firstChild.nodeValue` 访问。

- 示例：

  ```js
  const paragraph = document.getElementById("para");
  // 获取文本内容（元素的第一个子节点是文本节点）
  const text = paragraph.firstChild.nodeValue;
  // 修改文本内容
  paragraph.firstChild.nodeValue = "新的文本内容";
  ```

### 便捷访问子节点的属性

- `firstChild`：等价于 `childNodes[0]`，返回第一个子节点；
- `lastChild`：等价于 `childNodes[childNodes.length - 1]`，返回最后一个子节点。

## 关键补充

- **`childNodes` 的特殊性**：包含所有节点类型（包括空格、换行符等文本节点），使用时需结合 `nodeType` 过滤无效节点。
- **`onload` 事件**：常用于页面加载完成后执行初始化函数（如 `window.onload = init;`），确保 DOM 已完全解析。
- **`nodeValue` 的适用范围**：仅文本节点和属性节点有实际值，元素节点的 `nodeValue` 为 `null`。
