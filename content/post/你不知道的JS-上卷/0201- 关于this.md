---
# 文章标题
title: 2.1节 关于this
# 文章内容摘要
# description: 本文详细介绍了 Git 这一分布式版本控制系统的优点，对比了 Windows 与 macOS/Linux 系统下的常用命令，讲解了 vim 操作模式及常用命令，还阐述了 Git 的基本配置、特定项目配置和命令缩写设置等内容。
# 文章内容关键字
keywords: JavaScript this, 绑定规则，显式绑定，new 绑定，箭头函数 this, 词法 this
# 发表日期
date: 2025-06-04
summary: 本节详细介绍了 JavaScript 中 this 的绑定规则，包括默认绑定、隐式绑定、显式绑定、new 绑定以及优先级判断。同时，还介绍了箭头函数 this 的特点以及词法 this 的使用。
# 分类
categories:
  - 你不知道的JS
# 标签
tags:
  - JavaScript
  - ECMAScript
  - 前端开发
---

## this 是什么

**this** 是在**运行时**进行绑定的，而不是在编写时绑定的。它的上下文取决于**函数调用时的各种条件**，与函数声明的位置**无关**，只取决于**函数的调用方式**。

函数被调用时会创建一个**活动记录（执行上下文）**，其中包含：

- 函数的调用位置（调用栈）
- 函数的调用方式
- 传入的参数

**this** 是这个记录的一个属性，在函数执行过程中会被使用。

**调用位置**：函数在代码中被调用的位置（非声明位置）。

**调用栈**：为了到达当前执行位置而调用的所有函数。当前执行的函数的调用位置是其**调用栈中的前一个调用**。

## 绑定规则

### 默认绑定

**独立函数调用**：直接调用函数引用（不带修饰）。只能使用默认绑定，无法应用其他规则。

**非严格模式**：this 绑定到**全局对象**。

**严格模式**：this 绑定到 **undefined**。

### 隐式绑定

当函数引用有上下文对象时，this 会绑定到该上下文对象。

对象属性引用链中，**只有最后一层**在调用位置起作用。

若隐式绑定的函数**丢失绑定对象**，则会使用默认绑定：this 会绑定到全局对象或 undefined。

### 显示绑定

若不想在对象中包含函数引用，可使用 `call` 或 `apply` 强制绑定。

它们的第一个参数是 this 的绑定对象。

若传入原始值作为绑定对象，会被**装箱**成对应的对象形式。

硬绑定：显示绑定的强制版本。典型做法是创建一个**包装函数**，接收并返回原函数调用结果。

可用于创建**可复用的辅助函数**。

ES5 提供了内置方法 `Function.prototype.bind`：

- 返回一个**硬编码的新函数**；
- 该函数的 this 被固定为指定对象；
- 可传入部分参数（**部分应用 / 柯里化**）。

许多函数提供可选参数 `context`，与 `bind` 作用相同。这些函数内部通常通过 `call` 或 `apply` 实现显示绑定。

### new 绑定

在 JS 中，构造函数是被 `new` 操作符调用的普通函数。包括内置对象函数在内的所有函数都可用 `new` 调用。

使用 new 时的步骤：

- 创建一个全新的对象。
- 将该新对象的 `[[prototype]]` 连接起来。
- 将该新对象绑定到函数调用的 this。
- 若函数未返回其他对象，则返回该新对象。

## 优先级

**bind 的功能之一**：除 this 绑定外，还可传递其他参数（部分应用 / 柯里化）。

在判断 this 绑定规则时，遵循以下优先级顺序：

- **new 调用**：this 绑定到新创建的对象。
- **call / apply / bind 调用**：this 绑定到指定对象。
- **上下文对象调用**：this 绑定到该上下文对象。
- **默认绑定**：严格模式下绑定到 undefined，否则绑定到全局对象。

## 绑定例外

若将 `null` 或 `undefined` 作为 this 传入 `call`、`apply`、`bind`，这些值会被忽略，应用默认绑定规则。

常见用法：

- `apply` 常用于展开数组作为函数参数。
- `bind` 可预先设置部分参数，实现柯里化。

若函数使用了 this，而默认绑定将其绑定到全局对象，可能导致不可预期后果。

更安全的做法：将 this 绑定到一个**空对象**，如：`Object.create(null)`，该对象比 `{}` 更“空”，不含 `Object.prototype` 委托。

若函数的引用被间接创建或传递，会应用**默认绑定**。

参数传递是一种**隐式赋值**，传入函数时也会受此影响。

决定 this 绑定对象的不是调用位置是否严格模式，而是**函数体**是否严格模式。若函数体是严格模式 ，this 绑定到 undefined；否则，this 绑定到全局对象。

一些 JS 库的回调函数可能**强制修改 this**；事件处理器常将 this 绑定到触发事件的 DOM 元素。

## this 词法

箭头函数绑定规则：不使用 this 的四种标准规则，this 取决于**外层函数或全局作用域**。

箭头函数的绑定**无法被修改**。

箭头函数特点：

- 类似 `bind`，可确保 this 绑定到指定对象；
- 使用更常见的**词法作用域**机制取代传统 this。
