---
# 文章标题
title: 1.3节 函数作用域和块作用域
# 文章内容摘要
# description: 本文详细介绍了 Git 这一分布式版本控制系统的优点，对比了 Windows 与 macOS/Linux 系统下的常用命令，讲解了 vim 操作模式及常用命令，还阐述了 Git 的基本配置、特定项目配置和命令缩写设置等内容。
# 文章内容关键字
keywords: JavaScript 函数作用域，块作用域，函数声明与表达式，立即执行函数 (IIFE), let/const, 作用域隔离,JavaScript 声明提升，变量提升，函数提升，暂时性死区，重复声明覆盖，块级函数声明
# 发表日期
date: 2025-05-31
summary: 本节详细介绍了 JavaScript 中的函数作用域和块作用域，包括函数作用域的核心特性、函数声明与表达式的区别、立即执行函数表达式（IIFE）的用途和块作用域的特性与实现,还介绍了 JavaScript 中变量和函数声明的提升机制，包括提升的本质、分类、优先级、特殊情况及注意事项。
# 分类
categories:
  - 你不知道的JS
# 标签
tags:
  - JavaScript
  - ECMAScript
  - 前端开发
---

## 函数中的作用域

**函数作用域**：属于函数的全部变量都可以在整个函数范围内使用及复用。在嵌套作用域中，也可以访问外层作用域中的变量。

## 隐藏内部实现

通过将变量和函数包裹在一个函数作用域中，可以**隐藏内部实现**。

这一做法体现了 **最小特权原则（最小授权/最小暴露原则）**：在软件设计中应尽量只暴露必要内容，将其他内容隐藏起来（如模块或对象的 API 设计）。

### 优点

**避免命名冲突**：隐藏作用域中的变量和函数，可防止同名标识符覆盖或污染。

**防止全局冲突**：多个第三方库若未隐藏私有内容，可能在全局作用域中造成冲突。

常见解决方法：在全局声明一个独特名称的对象作为命名空间；所有需要暴露的功能作为该对象的属性。

现代模块机制通过模块管理器避免冲突：

- 无需在全局作用域中暴露标识符；
- 依赖管理器可将库的标识符**显式导入特定作用域**。

## 函数作用域

**函数声明（Function Declaration）**：`function` 是声明中的**第一个词**。

**函数表达式（Function Expression）**：`function` 出现在声明的**中间或末尾**。

区别：

- 函数声明的名称标识符绑定在**所在作用域**中；
- 函数表达式的名称标识符绑定在**函数自身内部作用域**中。

### 匿名和具名

函数声明 **必须有函数名**，函数表达式可以匿名。

**匿名函数问题**：

- 栈追踪中没有有意义的名称，**调试困难**；
- 无法引用自身，只能使用已废弃的 `arguments.callee`；
- 缺乏描述性名称，降低代码可读性。

**最佳实践**：始终为函数表达式命名。

### 立即执行函数表达式

**IIFE**：将函数包含在括号中，使其成为表达式，并在末尾加括号立即执行。

常见用法：

- 使用匿名函数表达式；
- 可向 IIFE 传递参数；
- 可防止 `undefined` 被覆盖；
- 可用于**倒置运行顺序**：先定义后执行。

## 提升

JS 引擎在执行代码前会**先编译**；编译时会**找到所有声明**并与作用域关联；

**声明会被提升**，而赋值和逻辑留在原处；

每个作用域都会执行提升操作。

**函数声明会被提升**；**函数表达式不会被提升**；即使具名函数表达式，其名称在赋值前也不可用。

### 函数优先

函数的提升优先于变量；

重复的 `var` 声明会被忽略；后出现的函数声明会覆盖前面的声明；

普通块中的函数声明也会被提升，应**避免在块内声明函数**。

## 块作用域

变量应尽量**局部化**，距离使用处越近越好；

块作用域可视为最小授权原则的延伸：从“函数中隐藏信息”扩展到“块中隐藏信息”。

### with

`with` 从对象创建的作用域**仅在语句内部有效**，不影响外层作用域。

### try/catch

`catch` 子句会创建一个**块作用域**，其中声明的变量仅在 `catch` 内部有效；

在 ES6 之前，可作为块作用域的替代方案。

### let

`let` 可将变量绑定到任意块作用域（通常是花括号内）。

**不会提升**：声明前变量在作用域中不存在。

在 `for` 循环头中：每次迭代都会重新绑定 `i`，可确保使用前一迭代结束时的值。

### const

`const` 创建**块级作用域常量**；声明后值不可更改，修改会引发错误。
