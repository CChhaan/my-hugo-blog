---
# 文章标题
title: 5. 使用分支
# 文章内容摘要
# description: 本文详细介绍了 Git 这一分布式版本控制系统的优点，对比了 Windows 与 macOS/Linux 系统下的常用命令，讲解了 vim 操作模式及常用命令，还阐述了 Git 的基本配置、特定项目配置和命令缩写设置等内容。
# 文章内容关键字
keywords: Git 分支, git branch 命令, 创建分支, 删除分支, 更改分支名称, 切换分支, git checkout, Git HEAD, ORIG_HEAD, Git 分支原理, Git commit, Git 分支管理, Git 工作目录, 从 commit 创建分支, Git 分支操作
# 发表日期
date: 2025-07-05
summary: 本文主要介绍了 Git 分支的使用方法，包括创建分支、删除分支、更改分支名称、切换分支等操作，并详细讲解了 Git 分支的原理，包括分支的原理、切换分支时发生的事、如何知道现在是在哪个分支以及 ORIG_HEAD 的作用等。
# 分类
categories:
  - Git从入门到精通
# 标签
tags:
  - Git
  - 版本控制系统
---

## 使用分支

在 Git 中使用分支很简单，只要使用 `git branch` 命令即可。

如果 `git branch` 后面没有接任何参数，它仅会输出当前在这个项目中有哪些分支。

Git 默认会设置一个名为 **main** 的分支，前面的 **星号** 表示现在正在这个分支上。

### 新增分支

执行 `git branch` 命令时，在后面加上分支的名字即可新增一个分支。

### 更改分支名称

使用 `-m` 参数更改分支名称。

```bash
git branch -m old new
```

即使是 **main 分支** 也可以改。

更改分支名称不会影响文件或目录。

### 删除分支

使用 `-d` 参数删除分支。

```bash
git branch -d 分支名
```

如果要删除的分支还没有被完全合并，Git 会有提示。

此时改用 **-D** 参数即可强制删除。

**任何分支都可以删除**，包括 **main** 分支。

**当前所在的分支不能删**，必须先切换到其他分支再删除。

### 切换分支

使用 `git checkout` 切换分支。

```bash
git checkout 分支名
```

切换后，执行 `add` 和 `commit` 操作时，只有 **当前所在的分支** 会前进。

要切换到的分支必须先存在，否则会报错。

使用 `-b` 参数可在切换时直接创建新分支：

- 如果分支存在 → 直接切换
- 如果分支不存在 → 创建并切换过去

## 分支的原理

分支就是一张贴纸，贴在某一个 commit 上。

新的 commit 会指向前一个 commit，而当前分支（HEAD 所指）会贴到新的 commit 上，HEAD 也会跟着前进。

Git 的分支不是通过复制目录或文件生成的，而只是一个指标。

分支其实就是一个 **只有 40 个字节的文件**，位于 `.git/refs/heads` 目录中。

### 切换分支时发生的事

- **更新暂存区和工作目录**

  - Git 会用目标分支指向的 commit 内容更新暂存区和工作目录。
  - 切换前的改动会保留在工作目录中，不受影响。
  - 每次 commit 都是一个对象，指向某个 tree 对象，而这些 tree 又指向其他 tree 或 blob 对象，类似葡萄串。

  → 切换分支不会影响工作目录中已有的改动。

- **变更 HEAD 的位置**

  - HEAD 会指向刚切换过去的分支。
  - `.git/HEAD` 文件内容会被改动。

### git 如何知道现在是在哪个分支

执行 `git branch` 可看到所有分支列表，**星号表示当前分支**。

`.git` 目录中的 **HEAD 文件** 记录了当前指向的分支。

切换分支时，HEAD 内容会变化。

使用 `@` 可代替 `HEAD`。

### ORIG_HEAD

`.git` 目录中有一个 **ORIG_HEAD** 文件。

在执行危险操作时，Git 会把 HEAD 的状态存放在其中，方便随时回退到危险动作前的状态。

`git reflog` 也能查到相关信息，但数据较复杂。

ORIG_HEAD 可方便地找到最近一次危险动作之前的 **SHA-1 值**。

## 从过去的某个 commit 再创建一个新的分支

回到目标 commit：

```bash
git checkout SHA-1
```

从该 commit 开出新分支并切换：

```bash
git checkout -b 分支名
```

也可以直接一行完成：

```bash
git branch -b 分支名 SHA-1
```
