---
# 文章标题
title: 7.4 安全
# 文章内容摘要
# description:
# 文章内容关键字
keywords: Vue 安全, 前端安全, XSS 防护, 模板安全, HTML 注入, JavaScript 注入, URL 注入, 样式注入, 用户内容安全, Vue 最佳实践
# 发表日期
date: 2025-04-20
summary: 本文主要介绍了 Vue 3 中的安全机制，包括如何避免 HTML 注入、JavaScript 注入、URL 注入、样式注入等安全问题，以及 Vue 的最佳实践。
# 分类
categories:
  - Vue3文档阅读
# 标签
tags:
  - vue
  - vue3
  - 前端框架
  - 前端开发
---

## 首要规则：不要使用无法信赖的模板

使用 Vue 时最基本的安全规则就是：**不要将无法信赖的内容作为组件模板**。

使用无法信赖的模板 = 允许任意 JavaScript 在应用中执行。

在服务端渲染时执行这些代码 → **可能导致服务器被攻击**。

**原因**：

- Vue 模板会被编译成 JavaScript，模板内的表达式将作为渲染过程的一部分被执行。
- 由于全局执行环境的复杂性，Vue 无法在性能开销合理的前提下完全避免潜在的恶意代码执行。

**直接方法**：确保 Vue 模板始终可信，并完全由自己控制。

## Vue 自身的安全机制

### HTML 内容

无论使用模板还是渲染函数，**内容都会自动转义**。

转义通过 `textContent` 等浏览器原生 API 完成。

只有浏览器本身存在漏洞时，才会出现漏洞。

### Attribute 绑定

动态 attribute 的绑定也会**自动转义**。

转义通过 `setAttribute` 等浏览器原生 API 完成。

同样，只有浏览器存在漏洞时才会受影响。

## 潜在的危险

在任何 Web 应用中，允许执行未经无害化处理的用户提供内容（HTML、CSS、JavaScript）都存在安全隐患，应尽可能避免。

### 注入 HTML

Vue 会自动转义 HTML，避免可执行 HTML 注入。

**例外**：当确定 HTML 安全时，可以显式渲染 HTML。

**结论**：用户提供的 HTML 永远不安全，除非：

- 在 iframe 沙盒环境中，或
- 该 HTML 仅被该用户看到。

允许用户编写自己的 Vue 模板也存在类似危险。

### URL 注入

如果 URL 允许通过 `javascript:` 执行 JavaScript → **存在潜在问题**。

**结论**：

- **任何用户提供的 URL 必须在后端先做无害化处理**，然后再保存到数据库。
- 即使是经过无害化处理的 URL，Vue 也不能保证其目标安全。

### 样式注入

恶意用户能利用 CSS 进行“点击劫持”。

若允许在 `<style>` 中插入用户提供内容 → **更大漏洞**（控制整个页面样式）。

Vue 阻止在模板中渲染 `<style>` 标签。

**建议**：

- 仅在沙盒 iframe 中允许用户控制 CSS。
- 当允许样式绑定时，应使用 **对象值形式**，并限制为可安全控制的特定属性。

### JavaScript 注入

**禁止在 Vue 中渲染 `<script>`**。

HTML 元素的事件属性（如 `onclick`、`onfocus`、`onmouseenter`）也可能接受 JavaScript 字符串，存在风险。

**结论**：用户提供的 JavaScript 永远不安全，除非：

- 在 iframe 沙盒环境中，或
- 仅在该用户登录页面上执行。

#### 常见问题场景

1. 开发者显式渲染了未经无害化处理的用户内容 → **本身不安全**。
2. 开发者将 Vue 挂载到包含服务端渲染或用户提供内容的 DOM 节点上 → **与 #1 类似的风险**。

**最佳实践**：

- **不要将 Vue 挂载到可能包含服务端渲染或用户提供内容的 DOM 节点上**。

## 最佳实践

**核心规则**：只要执行了未经无害化处理的用户内容（HTML、JavaScript、CSS），就可能遭受攻击。

使用 Vue、其他框架，或不使用框架，结论都相同。
