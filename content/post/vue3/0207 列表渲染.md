---
# 文章标题
title: 2.7 列表渲染
# 文章内容摘要
# description:
# 文章内容关键字
keywords: Vue v-for, Vue 列表渲染, Vue v-for key, Vue v-if 与 v-for, Vue 遍历对象, Vue 数组更新, Vue 组件循环, Vue 响应式数组, Vue 计算属性过滤, Vue 列表优化
# 发表日期
date: 2025-04-11
summary: 本文主要介绍 Vue3 列表渲染相关内容，包括 `v-for` 指令、在 `v-for` 里使用范围值、`v-for` 与对象、`<template>` 上的 `v-for`、`v-for` 与 `v-if`、通过 key 管理状态、组件上使用 `v-for`、数组变化侦测等。
# 分类
categories:
  - vue3文档阅读
# 标签
tags:
  - vue
  - vue3
  - 前端框架
  - 前端开发
---

## `v-for`

基于数组渲染列表。

**语法**：`item in items`

- `items`：源数据数组
- `item`：迭代项的**别名**

**特点**：

- 可以访问父作用域内的属性和变量。
- 可选的第二个参数表示当前项的索引。
- 支持在定义别名时使用解构。
- 多层嵌套时，作用域类似函数作用域，每个作用域可访问父级作用域。
- `of` 可以替代 `in`，更接近 JavaScript 迭代器语法。

## `v-for` 与对象

可遍历对象的所有属性。

**顺序**：基于 `Object.values()` 的返回顺序。

**参数**：

- 第二个参数：属性名
- 第三个参数：索引

## 在 `v-for` 里使用范围值

可以直接接受一个整数值。

**效果**：模板会基于 `1...n` 的取值范围重复渲染多次。

## `<template>` 上的 `v-for`

可在 `<template>` 标签上使用 `v-for` 来渲染包含多个元素的块。

## `v-for` 与 `v-if`

- **优先级**：`v-if` 比 `v-for` 更高。
  - 结果：`v-if` 的条件无法访问 `v-for` 的别名。
- **解决方法**：在外层包装 `<template>` 并在其上使用 `v-for`。
- **结论**：同时使用 **不推荐**，因优先级不明显。
- **常见情况**：
  - 过滤列表项：
    - 示例：`v-for="user in users" v-if="user.isActive"`
    - 替代方案：使用新的计算属性（如 `activeUsers`）。
  - 避免渲染隐藏的列表：
    - 示例：`v-for="user in users" v-if="shouldShowUsers"`
    - 替代方案：将 `v-if` 移至容器元素（如 `ul`、`ol`）。

## 通过 key 管理状态

**默认策略**：Vue 按“就地更新”方式更新 `v-for` 渲染的元素，不移动 DOM 元素顺序。

**适用场景**：仅当渲染结果不依赖子组件状态或临时 DOM 状态（如表单值）。

**提示机制**：为每个元素提供唯一的 `key` 属性。

**规则**：

- 使用 `<template v-for>` 时，`key` 应放在 `<template>` 上。
- 推荐在可行时总是提供 `key`。
- `key` 的值应为基础类型（字符串或 number），**不要使用对象**。

## 组件上使用 `v-for`

**用法**：可以直接在组件上使用 `v-for`，需提供 `key`。

**注意**：

- 不会自动传递数据给组件，组件有自己独立作用域。
- 需通过 props 传递数据。
- 不自动注入 `item` 是为了避免组件与 `v-for` 耦合。

## 数组变化侦测

### 变更方法

Vue 能侦听以下数组方法，并触发更新：

- `push()`
- `pop()`
- `shift()`
- `unshift()`
- `splice()`
- `sort()`
- `reverse()`

### 替换一个数组

**变更方法**：直接修改原数组。

**不可变方法**：如 `filter()`、`concat()`、`slice()`，返回新数组，不修改原数组。

**做法**：使用新数组替换旧数组。

**效率**：Vue 会最大化 DOM 元素重用，即使新数组部分重叠，也高效。

## 展示过滤或排序后的结果

**需求**：显示经过过滤或排序的数组，但不修改原始数据。

**做法**：使用计算属性返回过滤或排序后的数组。

**注意**：

- `reverse()` 和 `sort()` 会修改原数组。
- 计算属性中不应直接修改原数组，应先创建副本再调用这些方法。
