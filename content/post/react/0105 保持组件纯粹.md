---
# 文章标题
title: 1.5 保持组件纯粹
# 文章内容摘要
# description: 本文详细介绍了 Git 这一分布式版本控制系统的优点，对比了 Windows 与 macOS/Linux 系统下的常用命令，讲解了 vim 操作模式及常用命令，还阐述了 Git 的基本配置、特定项目配置和命令缩写设置等内容。
# 文章内容关键字
keywords: React 纯函数, React 副作用, React 严格模式, React 组件纯粹性, 渲染纯函数原则, 局部 mutation, React side effects, useEffect 使用场景, React 事件处理副作用, React 性能优化, 组件输入只读, mutation 在 React 中, React 函数式编程理念, React 渲染机制, React 最佳实践
# 发表日期
date: 2025-10-09
summary: 本文介绍了 React 中保持组件纯粹的重要性，以及如何编写纯函数和避免副作用。
# 分类
categories:
  - React文档阅读
# 标签
tags:
  - react
  - 前端框架
  - 前端开发
  - 组件化开发
---

## 纯函数：组件作为公式

在计算机科学中（尤其是函数式编程中），**纯函数** 具有以下特征：

- **只负责自己的任务**：不会更改在函数调用前已存在的对象或变量。
- **输入相同，则输出相同**：给定相同的输入，纯函数总是返回相同的结果。

**React 围绕纯函数的概念进行设计。**React 假设所有组件都是纯函数，即对于相同的输入，组件必须总是返回相同的 JSX。

## 副作用：（不符合）预期的后果

React 的渲染过程必须是纯粹的：

- 组件应 **只返回 JSX**，而不修改渲染前的对象或变量，否则会变得不纯粹。
- 不应假设组件的渲染顺序。
- 每个组件应当“独立思考”，不依赖或协调其他组件。

在 React 中，渲染时可以读取三种输入：`props`、`state`、`context`，这些输入应始终被视为**只读**。

当需要根据用户输入更改内容时，应使用 **状态设置**，而不是直接修改变量。渲染过程中，**禁止修改预先存在的变量或对象**。

React 提供 **严格模式** 来检测不纯组件，在严格模式下，React 会 **调用每个组件函数两次**，**纯函数仅执行计算，因此调用两次不会改变任何东西。**

严格模式仅在开发环境中生效，不会影响生产性能。

### 局部 mutation：组件的小秘密

在渲染过程中更改 **预先存在变量的值**，称为 **突变（mutation）**。纯函数不会改变函数作用域外的变量或已有对象。

你可以在渲染时更改 **刚刚创建的变量或对象**，这称为 **局部 Mutation**。

## 可能引发副作用的地方

**副作用（side effects）** 指那些在渲染之外发生的变化，例如：更新屏幕、启动动画、更改数据，这些行为是“额外的”，与渲染过程无关。

在 React 中，副作用通常属于 **事件处理程序**，事件处理程序在用户操作（如点击）时执行，即使定义在组件内部，也**不会在渲染期间运行**，**因此事件处理程序不需要是纯函数。**

如果无法在事件处理程序中处理副作用，可使用：`useEffect`在组件渲染完成后执行副作用。

**注意：** `useEffect` 应作为最后手段。尽量仅通过渲染表达逻辑。

编写纯函数虽然需要遵循一定的规程，但它带来了诸多好处：

- **跨环境运行：** 组件可在服务器上执行，为多个用户请求复用相同逻辑。
- **性能优化：** 对输入未变的组件可安全地跳过渲染或缓存结果。
- **高可中断性：** React 可在数据变化时中断并重新开始渲染，不浪费计算。

保持组件的纯粹性是 React 范式的核心。从数据获取到动画再到性能优化，**纯函数** 是构建可靠、高效 React 应用的基础。
