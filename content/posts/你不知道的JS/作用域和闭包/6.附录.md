---
title: "6.附录"
date: 2025-08-20T19:49:53
draft: false
---

> 摘要：词法作用域在代码定义时确定，关注函数声明位置；动态作用域在运行时确定，关注函数调用位置。ES6前可用try/catch模拟let的块作用域。箭头函数通过词法作用域绑定this，替代普通函数的this绑定规则，其效果类似于使用self变量或bind方法，解决了this指向问题。三种方式都能确保this正确指向外层对象（示例中的obj），但箭头函数提供了更简洁的语法实现。

词法作用域是在写代码或者说定义时确定的，而动态作用域是在运行时确定的，词法作用域关注函数在何处声明，而动态作用域关注函数从何处调用

---

ES6之前可以用catch实现let的效果

```js
{
    try {
        throw undefined;
    }catch(a){
        a=2
        console.log(a)
    }
}
console.log(a)
```

----

箭头函数放弃了普通this绑定的规则，取而代之的是用当前的词法作用域覆盖了this本来的值

```js
var obj = {
    count:0,
    cool: function coolFn(){
        if(this.count<1){
            setTimeout(()=>{
                this.count++;
            })
        }
    }
}
```

相当于：

```js
var obj = {
    count:0,
    cool: function coolFn(){
        var self = this
        if(self.count<1){
            setTimeout(function timer()=>{
                self.count++;
            })
        }
    }
}
```

相当于：

```js
var obj = {
    count:0,
    cool: function coolFn(){
        if(this.count<1){
            setTimeout(function timer()=>{
                this.count++;
            }.bind(this),100)
        }
    }
}
```

